(function(){var e,f,c,d,g,h;c=function(){Array.prototype.unshift.call(arguments,"topicsview:");return console.log.apply(console,arguments)};this.READY=!1;g=function(a){return postInputBean.newPost(a,"post")};this.spin=function(a){a?this.spin.count+=1:--this.spin.count;return $("#spin").spin(0<this.spin.count?"large":!1)};this.spin.count=0;this.updateTopic=function(a){var b;if(READY)return null!=(b=this.topicView)?b.updateTopic(a):void 0};this.addPost=function(a){var b;if(READY)return null!=(b=this.postView)?
b.addPost(a):void 0};this.updatePost=function(a){var b;if(READY)return null!=(b=this.postView)?b.updatePost(a):void 0};f=function(){var a,b;this.topicView=new topicjs.Topic(TOPIC_ID,{$container:$(".forum-topic")});b=$(".sec-topic");a=$(".sec-posts");this.postView=new postsjs.PostList({$container:a.children(".forum-posts"),$topicContainer:b.children(".forum-posts"),$more:a.find("> .footer > .btn-more"),topicId:TOPIC_ID,search:{sort:"createTime",asc:!0}});return topicView.show({success:function(){"talk"===
topicView.topic.type&&($("ul.filter > li.active").removeClass("active"),$('ul.filter > li[data-sort-key="updateTime"]').addClass("active"),postView.search.sort="updateTime",postView.search.asc=!1);return postView.show()}})};h=function(){var a,b;b=this.postView.search;a=$("ul.filter > li.active");b.sort=a.data("sort-key");b.asc=a.data("sort-asc");return postView.refresh()};e=function(){$(".new-post").click(function(){g(TOPIC_ID);return!1});return $("ul.filter > li > a").click(function(){var a;a=$(this).parent("li");
if(a.hasClass("active"))return!1;a.parent("ul").children("li.active").removeClass("active");a.addClass("active");h();return!1})};d=function(){if(null==this.i18nBean)return c("init: wait"),setTimeout(d,100);c("init: enter");moment.locale(LOCALE);topicjs.init();postsjs.init();f();e();this.READY=!0;return c("init: leave")};$(function(){return d()})}).call(this);
