(function(){var g,b,f,h,k,l,d=function(a,c){return function(){return a.apply(c,arguments)}};b=function(){};this.bindAmazon=function(){var a;b("bindAmazon: enter");a=$("iframe.amazon");a.load(function(){var c,a;a=$(this);c=a.contents().find("body");return c.html()?(c.css("background-color","transparent").find(".crIFrame").css("margin-left","-0.8em"),c.find(".crIFrameLogo,.crIframeHeaderTitle").remove()):a.remove()});$(window).on("scroll resize",function(){var c;c=this.viewBean.width();return a.width(c-
74)});$("iframe.amazon").error(function(){return $(this).remove()});return b("bindAmazon: leave")};this.bindYoutube=function(){var a,c;b("bindYoutube: enter");c=function(c){var a,b;b=Math.round(zoomer.youtubeFrameWidth());a=Math.round(zoomer.youtubeFrameHeight());return'<iframe width="'+b+'" height="'+a+'" src="http://youtube.com/embed/'+c+'" frameborder="0" allowfullscreen />'};a=$("body").data("id");$(".btn-dl-img").click(function(){bean.getimg(a);return!1});$(".btn-dl-yt").click(function(){bean.getyt(a);
return!1});MAINLAND?$(".youtube .btn-dl,.youtube .btn-play,.youtube .label,.youtube img").click(function(){var c;c=$(this).closest(".youtube").data("id");youtubeBean.get(c);return!1}):($(".youtube .btn-dl").click(function(){var c;c=$(this).closest(".youtube").data("id");youtubeBean.get(c);return!1}),$(".youtube .btn-play,.youtube .label,.youtube img").click(function(){var a,b,d,f,e;e=$(this).closest(".youtube");f=e.find(".label");d=e.find("img");b=e.find("iframe");a=e.find(".btn-play");b.length?(a.prop("title",
"\u518d\u751f").find(".fa-stop").removeClass("fa-stop").addClass("fa-play"),f.removeClass("label-info").removeClass("label-success"),b.remove(),b=zoomer.youtubeWidth(),a="",e.removeClass("iframe").width(b).height(a),d.show()):(a.prop("title","\u505c\u6b62").find(".fa-play").removeClass("fa-play").addClass("fa-stop"),f.removeClass("label-info").addClass("label-success"),d.hide(),b="100%",a=zoomer.youtubeFrameHeight()+30,e.addClass("iframe").width(b).height(a),d=e.data("id"),a=c(d),e.append(a));return!1}));
return b("bindYoutube: leave")};g=function(){function a(a){this.viewBean=a;this.youtubeFrameHeight=d(this.youtubeFrameHeight,this);this.youtubeFrameWidth=d(this.youtubeFrameWidth,this);this.zoomYoutube=d(this.zoomYoutube,this);this.youtubeWidth=d(this.youtubeWidth,this);this.zoom=d(this.zoom,this);this.bind=d(this.bind,this);this.maxWidth=d(this.maxWidth,this);this.ratio=1;this.bind()}a.prototype.maxWidth=function(){return Math.max(0,this.viewBean.width()-90)};a.prototype.bind=function(){return $(window).resize(function(a){return function(){return a.zoomYoutube(a.ratio)}}(this))};
a.prototype.zoom=function(a){this.ratio=a;$(".chara").width(100*a);$(".cg").width(220*a);$(".cover").width(230*a);return this.zoomYoutube(a)};a.prototype.youtubeWidth=function(a){return Math.min(220*(null!=a?a:this.ratio),this.maxWidth())};a.prototype.zoomYoutube=function(a){return $(".youtube:not(.iframe)").width(this.youtubeWidth(a))};a.prototype.youtubeFrameWidth=function(){return Math.min(480*this.ratio,Math.max(480,this.maxWidth()))};a.prototype.youtubeFrameHeight=function(){return 9*this.youtubeFrameWidth()/
16};return a}();l=function(){var a;b("bindToolbar: enter");this.zoomer=new g(this.viewBean);a=new ZoomSlider(function(a){return function(b){return a.zoomer.zoom(1+2*b)}}(this));new Toolbar(this.viewBean,{width:60,height:244,move:a.reloadOffset});return b("bindToolbar: leave")};k=function(){b("bindRuby: enter");$.fn.inject=function(){return this.each(function(){return window.injectruby(this)})};$(".ruby").inject();return b("bindRuby: leave")};h=function(){var a;a=$("section.cg");return a.find("input.switch").bootstrapSwitch().on("switchChange.bootstrapSwitch",
function(b,d){if(!d)return a.find(".images").fadeOut()})};f=function(){if(null==this.bean)return b("init: wait"),setTimeout(f,100);b("init: enter");l();h();k();return b("init: leave")};$(function(){return f()})}).call(this);
