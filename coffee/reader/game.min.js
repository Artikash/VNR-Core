(function(){var g,b,f,h,k,l,c=function(a,d){return function(){return a.apply(d,arguments)}};b=function(){};this.bindAmazon=function(){var a;b("bindAmazon: enter");a=$("iframe.amazon");a.load(function(){var d,a;a=$(this);d=a.contents().find("body");return d.html()?(d.css("background-color","transparent").find(".crIFrame").css("margin-left","-0.8em"),d.find(".crIFrameLogo,.crIframeHeaderTitle").remove()):a.remove()});$(window).on("scroll resize",function(){var d;d=this.viewBean.width();return a.width(d-
74)});$("iframe.amazon").error(function(){return $(this).remove()});return b("bindAmazon: leave")};this.bindYoutube=function(){var a,d;b("bindYoutube: enter");d=function(d){var a,b;b=Math.round(zoomer.youtubeFrameWidth());a=Math.round(zoomer.youtubeFrameHeight());return'<iframe width="'+b+'" height="'+a+'" src="http://youtube.com/embed/'+d+'" frameborder="0" allowfullscreen />'};a=$("body").data("id");$(".btn-dl-img").click(function(){bean.getimg(a);return!1});$(".btn-dl-yt").click(function(){bean.getyt(a);
return!1});MAINLAND?$(".youtube .btn-dl,.youtube .btn-play,.youtube .label,.youtube img").click(function(){var a;a=$(this).closest(".youtube").data("id");youtubeBean.get(a);return!1}):($(".youtube .btn-dl").click(function(){var a;a=$(this).closest(".youtube").data("id");youtubeBean.get(a);return!1}),$(".youtube .btn-play,.youtube .label,.youtube img").click(function(){var a,b,c,f,e;e=$(this).closest(".youtube");f=e.find(".label");c=e.find("img");b=e.find("iframe");a=e.find(".btn-play");b.length?(a.prop("title",
"\u518d\u751f").find(".fa-stop").removeClass("fa-stop").addClass("fa-play"),f.removeClass("label-info").removeClass("label-success"),b.remove(),b=zoomer.youtubeWidth(),a="",e.removeClass("iframe").width(b).height(a),c.show()):(a.prop("title","\u505c\u6b62").find(".fa-play").removeClass("fa-play").addClass("fa-stop"),f.removeClass("label-info").addClass("label-success"),c.hide(),b="100%",a=zoomer.youtubeFrameHeight()+30,e.addClass("iframe").width(b).height(a),c=e.data("id"),a=d(c),e.append(a));return!1}));
return b("bindYoutube: leave")};g=function(){function a(a){this.viewBean=a;this.youtubeFrameHeight=c(this.youtubeFrameHeight,this);this.youtubeFrameWidth=c(this.youtubeFrameWidth,this);this.zoomYoutube=c(this.zoomYoutube,this);this.youtubeWidth=c(this.youtubeWidth,this);this.zoom=c(this.zoom,this);this.bind=c(this.bind,this);this.maxWidth=c(this.maxWidth,this);this.ratio=1;this.bind()}a.prototype.maxWidth=function(){return Math.max(0,this.viewBean.width()-90)};a.prototype.bind=function(){return $(window).resize(function(a){return function(){return a.zoomYoutube(a.ratio)}}(this))};
a.prototype.zoom=function(a){this.ratio=a;$("img.zoom.zoom-cover").width(230*a);$("img.zoom.zoom-cg").width(220*a);$("section.cg .images").masonry();return this.zoomYoutube(a)};a.prototype.youtubeWidth=function(a){return Math.min(220*(null!=a?a:this.ratio),this.maxWidth())};a.prototype.zoomYoutube=function(a){return $(".youtube:not(.iframe)").width(this.youtubeWidth(a))};a.prototype.youtubeFrameWidth=function(){return Math.min(480*this.ratio,Math.max(480,this.maxWidth()))};a.prototype.youtubeFrameHeight=
function(){return 9*this.youtubeFrameWidth()/16};return a}();l=function(){var a;b("bindToolbar: enter");this.zoomer=new g(this.viewBean);a=new ZoomSlider(function(a){return function(b){return a.zoomer.zoom(1+2*b)}}(this));new Toolbar(this.viewBean,{width:60,height:244,move:a.reloadOffset});return b("bindToolbar: leave")};k=function(){b("bindRuby: enter");$.fn.inject=function(){return this.each(function(){return window.injectruby(this)})};$(".ruby").inject();return b("bindRuby: leave")};h=function(){var a;
a=$("section.cg");return a.find("input.switch").bootstrapSwitch().on("switchChange.bootstrapSwitch",function(b,c){if(!c)return a.find(".images").fadeOut()})};f=function(){if(null==this.bean)return b("init: wait"),setTimeout(f,100);b("init: enter");l();h();k();return b("init: leave")};$(function(){return f()})}).call(this);
