(function(){var l,m,n,p,q,r,s,k,t;l=" \n\r\t\f\x0B\u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000".split("");k=function(a){return null!=a?a.toString():""};n=function(a,b){var c,g,d,e,f,h;null==b&&(b=l);a=k(a);h=0;f=a.length;g=b.length;for(d=!0;d&&h<f;)for(d=!1,e=-1,c=a.charAt(h);++e<g;)if(c===b[e]){d=!0;++h;break}return h>=f?"":a.substr(h,f)};s=function(a,b){var c,g,d,e,f;null==b&&(b=l);a=k(a);d=a.length-1;g=b.length;for(e=!0;e&&0<=
d;)for(e=!1,f=-1,c=a.charAt(d);++f<g;)if(c===b[f]){e=!0;--d;break}return 0<=d?a.substring(0,d+1):""};t=function(a,b){null==b&&(b=l);a=k(a);return n(s(a,b),b)};q=function(a,b,c,g){var d,e;d=document.createElement("rb");d.textContent=a;e=document.createElement("rt");e.textContent=b;b=document.createElement("ruby");c&&(b.title=c);b.className=g;b.appendChild(d);b.appendChild(e);b.ondblclick=function(){if(a&&ttsBean.isEnabled())return ttsBean.speak(a)};return b};p=function(a){var b,c,g,d,e,f,h,l,k;if(b=
jlpBean.parse(a)){a=document.createDocumentFragment();k=JSON.parse(b);e=0;for(h=k.length;e<h;e++){d=k[e];b=document.createElement("span");b.className="inject-ruby";g="";f=0;for(l=d.length;f<l;f++)c=d[f],g+=c[0],c=q.apply(this,c),b.appendChild(c);g&&(b.onclick=function(a){return function(){if(ttsBean.isEnabled())return ttsBean.speak(a)}}(g));a.appendChild(b)}return a}};r=function(a){var b;return"#text"===a.nodeName?(b=document.createElement("span"),b.className="inject-src",b.textContent=a.textContent,
b):a.cloneNode()};m=function(a,b){var c;a=a.firstChild;for(c=[];null!=a;)3===a.nodeType?b.push(a):1===a.nodeType&&m(a,b),c.push(a=a.nextSibling);return c};this.injectruby=function(a){var b,c,g,d,e,f;b=[];m(a,b);f=[];d=0;for(e=b.length;d<e;d++)a=b[d],(c=t(a.textContent))?(c=p(c))?(g=r(a),c.appendChild(g),f.push(a.parentNode.replaceChild(c,a))):f.push(void 0):f.push(void 0);return f}}).call(this);
