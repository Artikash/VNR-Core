(function(){var n,t,p,B,u,v,w,C,D,E,x,y,F,G,H,q,z,I,J,K,L,r,A,M,N=[].indexOf||function(a){for(var c=0,b=this.length;c<b;c++)if(c in this&&this[c]===a)return c;return-1};p=" \n\r\t\f\x0B\u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000".split("");r=function(a){return null!=a?a.toString():""};H=function(a,c){var b,e,d,f,g,h;null==c&&(c=p);a=r(a);h=0;g=a.length;e=c.length;for(d=!0;d&&h<g;)for(d=!1,f=-1,b=a.charAt(h);++f<e;)if(b===c[f]){d=
!0;++h;break}return h>=g?"":a.substr(h,g)};L=function(a,c){var b,e,d,f,g;null==c&&(c=p);a=r(a);d=a.length-1;e=c.length;for(f=!0;f&&0<=d;)for(f=!1,g=-1,b=a.charAt(d);++g<e;)if(b===c[g]){f=!0;--d;break}return 0<=d?a.substring(0,d+1):""};M=function(a,c){null==c&&(c=p);a=r(a);return H(L(a,c),c)};A=function(a){return a};F=function(a){return/[0-9a-zA-Z\uff10-\uff19\uff41-\uff5a\uff21-\uff3a]/.test(a)};G=function(a){return/[a-zA-Z\uff41-\uff5a\uff21-\uff3a'"?!,\.]/.test(a)};E=function(){return document.body.classList.contains("annot-opt-ruby")};
y=function(){return document.body.classList.contains("annot-opt-tts")};x=function(){return document.body.classList.contains("annot-opt-tr-tip")};D=function(){return document.body.classList.contains("annot-opt-tr")};q=function(){if(y())return ttsBean.speak(this.getAttribute("annot-text"))};z=function(){var a,c,b,e,d,f,g;if(x()&&!this.classList.contains("annot-locked")&&!this.classList.contains("annot-translated")){this.classList.add("annot-locked");this.classList.add("annot-translated");d=this.getAttribute("annot-text");
f=this.title;this.title=A("\u3061\u3087\u3063\u3068\u307e\u3063\u3066\u3066 ...");if(a=trBean.translators())for(e=a.split(","),a=0,b=e.length;a<b;a++)c=e[a],g=trBean.translate(d,c)||A("failed")+"!",f&&(f+="\n"),this.title=f+=c+": "+g;return this.classList.remove("annot-locked")}};B=function(a,c,b,e){var d,f;d=document.createElement("rb");d.textContent=a;f=document.createElement("rt");f.textContent=c;c=document.createElement("ruby");c.className=e;c.appendChild(d);c.appendChild(f);c.ondblclick=function(){if(a&&
y())return ttsBean.speak(a)};b&&(c.onmouseover=function(a){return function(){if(!x())return this.title=a}}(b),c.onmouseout=function(){if(this.title)return this.removeAttribute("title")});return c};I=function(a){var c,b,e,d,f,g,h,k,l,m,n,p;if(c=jlpBean.parse(a)){a=document.createDocumentFragment();h=JSON.parse(c);c=0;for(f=h.length;c<f;c++){n=h[c];l=document.createElement("span");l.className="annot-ruby";m="";d=!1;e=0;for(g=n.length;e<g;e++)p=n[e],k=p[0],(b=F(k[0]))&&d&&(m+=" ",d=document.createTextNode(" "),
l.appendChild(d)),d=G(k.slice(-1)),m+=k,k=B.apply(this,p),l.appendChild(k);m&&(l.setAttribute("annot-text",m),l.onclick=q,l.onmouseover=z);a.appendChild(l)}return a}};v=function(a,c){var b;b=document.createElement("span");b.className="annot-tr";b.title=c;null!=c?(b.textContent=a,b.setAttribute("annot-text",c),b.onclick=q):b.title=a;return b};n=/([\u3010\u3011\u300c\u300d\u300e\u300f\u266a])/;t=/(.*?[\u2026\u2025\uff01\uff1f\u3002?!]+)/;K=function(a){var c,b,e,d,f,g,h,k,l;k=document.createDocumentFragment();
g=a.split(n);c=0;for(e=g.length;c<e;c++)if(b=g[c],1===a.length&&0<=N.call(n,a))k.appendChild(v(b));else for(h=b.split(t),b=0,d=h.length;b<d;b++)f=h[b],""!==f&&(l=trBean.translate(f,null),null!=l&&k.appendChild(v(l,f)));return k};u=function(a,c){var b;b=document.createElement("span");b.className="annot-src";b.textContent=a;c&&(b.setAttribute("annot-text",a),b.onclick=q,b.onmouseover=z);return b};J=function(a,c){var b,e,d,f,g,h,k,l;l=document.createDocumentFragment();h=a.split(n);b=0;for(d=h.length;b<
d;b++)if(e=h[b],1===a.length&&0<=N.call(n,a))l.appendChild(u(e,!1));else for(k=e.split(t),e=0,f=k.length;e<f;e++)g=k[e],""!==g&&l.appendChild(u(g,!0));return l};C=function(a,c){var b,e;e=document.createElement("div");e.className="annot-container";b=document.createElement("div");b.className="annot-child";b.appendChild(a);e.appendChild(b);b=document.createElement("div");b.className="annot-child";b.appendChild(c);e.appendChild(b);return e};w=function(a,c){var b;a=a.firstChild;for(b=[];null!=a;)3===a.nodeType?
c.push(a):1===a.nodeType&&w(a,c),b.push(a=a.nextSibling);return b};this.annotate=function(a){var c,b,e,d,f,g,h,k,l,m;a.className+=" annot-root";f=[];w(a,f);a=E();c=D();k=m=null;h=[];b=0;for(e=f.length;b<e;b++)d=f[b],(g=M(d.textContent))?(a&&(k=I(g)),c&&(m=K(g,d)),l=J(g,d),null!=k||null!=m?(g=document.createDocumentFragment(),g.appendChild(l),k&&m?g.appendChild(C(k,m)):(null!=k&&g.appendChild(k),null!=m&&g.appendChild(m))):g=l,h.push(d.parentNode.replaceChild(g,d))):h.push(void 0);return h}}).call(this);
