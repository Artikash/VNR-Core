(function(){var h=function(g,f){function d(){this.constructor=g}for(var h in f)w.call(f,h)&&(g[h]=f[h]);d.prototype=f.prototype;g.prototype=new d;g.__super__=f.prototype;return g},w={}.hasOwnProperty,l=function(g,f){return function(){return g.apply(f,arguments)}},x=[].indexOf||function(g){for(var f=0,d=this.length;f<d;f++)if(f in this&&this[f]===g)return f;return-1};(function(g,f){return this.choco=new (function(){function d(){}var q,r,t,k,p,u,v,m;d.mixin=function(){return function(b){var a,e,c;e=
[];for(a in b)c=b[a],e.push(this.prototype[a]=c);return e}};d.prototype.feq=v=function(b,a){return 1.192E-7>Math.abs(b-a)};d.prototype.nop=m=function(){};d.prototype.Nop=function(){return m};d.prototype.Undefined=function(){};d.prototype.Null=function(){return null};d.prototype.True=u=function(){return!0};d.prototype.False=q=function(){return!1};d.prototype.List=r={remove:function(b,a){var e,c;for(c=[];~(e=g.indexOf(b,a));)c.push(b.splice(e,1));return c},removeFirst:function(b,a){var e;if(~(e=g.indexOf(b,
a)))return b.splice(e,1)},removeLast:function(b,a){var e;if(~(e=g.lastIndexOf(b,a)))return b.splice(e,1)}};d.prototype.escape=function(b){return b.replace(/[&"<>]/g,function(a){return{"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"}[a]})};d.defineClass=function(b,a,e){var c;null==a&&(a=null);null==a&&(a=f.capitalize(b));e.className=a;null!=(c=e.prototype)&&(c.className=a);d.prototype[b]=function(){return function(a,e,c){c.prototype=a.prototype;c=new c;a=a.apply(c,e);return Object(a)===a?a:c}(e,g.values(arguments),
function(){})};return d.prototype[a]=e};d.defineClass("prototype",null,k=function(b){function a(){a.__super__.constructor.apply(this,arguments)}h(a,b);a.propdef=function(a,c){return Object.defineProperty(this.prototype,a,c)};a.propget=function(a,c){return this.propdef(a,{get:c})};a.propset=function(a,c){return this.propdef(a,{set:c})};a.propalias=function(a,c){return this.propdef(a,{get:function(){return this[c]},set:function(a){return this[c]=a}})};a.alias=function(a,c){return this.prototype[a]=
this.prototype[c]};return a}(Object));d.defineClass("signal",null,p=function(b){function a(){this.emit=l(this.emit,this);this.disconnect=l(this.disconnect,this);this.connect=l(this.connect,this);a.__super__.constructor.apply(this,arguments);this._slots=[]}h(a,b);a.propget("slots",function(){return this._slots});a.propget("empty",function(){return!this._slots});a.prototype.connect=function(a){0>x.call(this._slots,a)&&this._slots.push(a);return this};a.prototype.disconnect=function(a){r.removeFirst(this._slots,
a);return this};a.prototype.emit=function(){var e,c,b,d,f;b=this._slots;d=[];e=0;for(c=b.length;e<c;e++)f=b[e],d.push((f instanceof a?f.emit:f).apply(null,arguments));return d};return a}(k));d.defineClass("object",null,t=function(b){function a(){a.__super__.constructor.apply(this,arguments)}h(a,b);a.signal=function(a){var c,b;b="on"+f.capitalize(a);c="_"+a;this.prototype[b]=m;return this.propget(a,function(){return null!=this[c]?this[c]:this[c]=(new p).connect(function(a){return function(){var c;
return null!=(c=a[b])?c.apply(null,arguments):void 0}}(this))})};a.property=function(a,c){var b,d,g,h,k,l,n;b=f.capitalize(a);n="on"+b+"Changed";l="set"+b;k="get"+b;b=a+"Changed";g="_"+b;d="_"+a;h=c===Number?function(a,c){return a===c||!isNaN(a)&&!isNaN(c)&&v(a,c)}:function(a,c){return a===c};this.prototype[n]=m;this.prototype[k]=function(){return null!=this[d]?this[d]:this[d]=null!=c?c.apply(this,arguments):void 0};this.prototype[l]=function(a){var b,e;if(!h(a,e=this[d])){null==a&&(a=null!=c?c.apply(this):
void 0);this[d]=a;if("function"===typeof this[n])this[n](a,e);return null!=(b=this[g])?b.emit(a,e):void 0}};this.propget(b,function(){return null!=this[g]?this[g]:this[g]=new p});return this.propdef(a,{get:function(){var a;return null!=(a=this[k])?a.apply(this,arguments):void 0},set:function(){var a;return null!=(a=this[l])?a.apply(this,arguments):void 0}})};a.prototype.bind=function(a,c,b){null==b&&(b=a);this[a]=c[b];return c[b+"Changed"].connect(this["set{_.capitalize prop}"])};return a}(k));d.defineClass("pair",
null,function(b){function a(b,c){this.first=b;this.second=c;a.__super__.constructor.apply(this,arguments)}h(a,b);return a}(k));d.defineClass("point",null,function(b){function a(b,c){this.x=null!=b?b:0;this.y=null!=c?c:0;a.__super__.constructor.apply(this,arguments)}h(a,b);return a}(k));d.defineClass("size",null,function(b){function a(b,c){this.width=null!=b?b:0;this.height=null!=c?c:0;a.__super__.constructor.apply(this,arguments)}h(a,b);return a}(k));d.defineClass("rect",null,function(b){function a(b,
c,d,f){this.x=null!=b?b:0;this.y=null!=c?c:0;this.width=null!=d?d:0;this.height=null!=f?f:0;a.__super__.constructor.apply(this,arguments)}h(a,b);return a}(k));d.defineClass("timer",null,function(b){function a(b,c,d){this.stop=l(this.stop,this);this.start=l(this.start,this);this.onTimeout=l(this.onTimeout,this);a.__super__.constructor.apply(this,arguments);null!=b&&(this.interval=b);null!=c&&this.timeout.connect(c);null!=d&&(this.singleShot=d)}h(a,b);a.singleShot=function(a,b){return setTimeout(b,
a)};a.property("interval",Number);a.property("active",q);a.property("singleShot",u);a.signal("timeout");a.prototype.onTimeout=function(){return this.singleShot?this.active=!1:this._timeoutId=setTimeout(this.timeout.emit,this.interval)};a.prototype.start=function(a){null!=a&&(this.interval=a);this.active&&this.stop();this._timeoutId=setTimeout(this.timeout.emit,this.interval);return this.active=!0};a.prototype.stop=function(){if(this.active)return clearTimeout(this._timeoutId),this.active=!1};return a}(t));
return d}())})(_,_.str)}).call(this);
