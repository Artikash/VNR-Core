(function(){var e,k,d,l,f,m,b=function(a,g){return function(){return a.apply(g,arguments)}};k=function(){function a(){this._translate=b(this._translate,this);this._renderTr=b(this._renderTr,this);this._renderText=b(this._renderText,this);this.addTr=b(this.addTr,this);this.addText=b(this.addText,this);this.pageBreak=b(this.pageBreak,this);this.hide=b(this.hide,this);this.show=b(this.show,this);this.isVisible=b(this.isVisible,this);var g,a;this.visible=!1;g=Haml.render('#sk-main\n  .header(title="Draggable")\n    .btn-close(title="Close") &times;\n  .body\n    .content');
this.$el=$(g).hide().appendTo(document.body);a=this.$el.children(".header");g=this.$el.children(".body");this.$el.draggable({handle:a});this.$text=g.children(".content");this.hamlText=Haml(".text #{text}");this.hamlTr=Haml('.tr(data-key="#{key}" title="#{key}") #{text}');a.find(".btn-close").click(function(){return m(!1)})}a.prototype.id="sk-text";a.prototype.isVisible=function(){return this.visible&&this.$el.is(":visible")};a.prototype.show=function(){if(!this.visible)return this.visible=!0,this.$el.fadeIn()};
a.prototype.hide=function(){if(this.visible)return this.visible=!1,this.$el.fadeOut()};a.prototype.pageBreak=function(){return this.visible?this.$text.empty():this.show()};a.prototype.addText=function(a){var c;this.pageBreak();c=this._renderText(a);this.$text.append(c);return this._translate(a)};a.prototype.addTr=function(a,c){var b;b=this._renderTr(a,c);return this.$text.append(b)};a.prototype._renderText=function(a){return this.hamlText({text:a})};a.prototype._renderTr=function(a,c){return this.hamlTr({text:a,
key:c})};a.prototype._translate=function(a){var c,b,e,d,h,f;if(c=trBean.translators()){d=c.split(",");h=[];c=0;for(e=d.length;c<e;c++)b=d[c],(f=trBean.translate(a,b))?h.push(this.addTr(f,b)):h.push(void 0);return h}};return a}();l=function(){return document.body.classList.contains("site-enabled")};m=function(a){var b;b=document.body;return a?b.classList.add("site-enabled"):b.classList.remove("site-enabled")};e=null;f=function(){var a;a=$("#game_frame").contents();if(a.length){a=a.find("#hasc_text");
if(a.length)return e=new k,a.bind("DOMSubtreeModified",function(){var a;l()&&(a=$.trim(this.textContent))&&(e.show(),e.addText(a));return!0});console.log("vnr: wait for text ready")}else console.log("vnr: wait for iframe ready");setTimeout(f,3E3)};d=function(){if(this.$&&this.$.ui&&this.Haml)return $(function(){if($("#game_frame").length)return f();console.log("vnr: wait for iframe ready");return setTimeout(d,3E3)});console.log("vnr: wait for libraries ready");return setTimeout(d,3E3)};d()}).call(this);
null
