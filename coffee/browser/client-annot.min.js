(function(){var m,r,n,s,z,A,B,t,u,C,D,E,p,v,F,G,H,I,q,w,J,K,x,y,L=[].indexOf||function(a){for(var c=0,b=this.length;c<b;c++)if(c in this&&this[c]===a)return c;return-1};n=" \n\r\t\f\x0B\u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000".split("");q=function(a){return null!=a?a.toString():""};E=function(a,c){var b,f,d,e,g,h;null==c&&(c=n);a=q(a);h=0;g=a.length;f=c.length;for(d=!0;d&&h<g;)for(d=!1,e=-1,b=a.charAt(h);++e<f;)if(b===c[e]){d=
!0;++h;break}return h>=g?"":a.substr(h,g)};I=function(a,c){var b,f,d,e,g;null==c&&(c=n);a=q(a);d=a.length-1;f=c.length;for(e=!0;e&&0<=d;)for(e=!1,g=-1,b=a.charAt(d);++g<f;)if(b===c[g]){e=!0;--d;break}return 0<=d?a.substring(0,d+1):""};J=function(a,c){null==c&&(c=n);a=q(a);return E(I(a,c),c)};w=function(a){return a};C=function(a){return/[0-9a-zA-Z\uff10-\uff19\uff41-\uff5a\uff21-\uff3a]/.test(a)};D=function(a){return/[a-zA-Z\uff41-\uff5a\uff21-\uff3a'"?!,\.]/.test(a)};B=function(){return document.body.classList.contains("annot-opt-ruby")};
u=function(){return document.body.classList.contains("annot-opt-tts")};t=function(){return document.body.classList.contains("annot-opt-tr-tip")};A=function(){return document.body.classList.contains("annot-opt-tr")};p=function(){if(u())return ttsBean.speak(this.getAttribute("annot-text"))};v=function(){var a,c,b,f,d,e,g;if(t()&&!this.classList.contains("annot-locked")&&!this.classList.contains("annot-translated")){this.classList.add("annot-locked");this.classList.add("annot-translated");c=this.getAttribute("annot-text");
b=this.title;this.title=w("\u3061\u3087\u3063\u3068\u307e\u3063\u3066\u3066 ...");if(a=trBean.translators())for(g=a.split(","),d=0,e=g.length;d<e;d++)a=g[d],f=trBean.translate(c,a)||w("failed")+"!",b&&(b+="\n"),this.title=b+=a+": "+f;return this.classList.remove("annot-locked")}};K=function(a,c,b,f){var d,e;d=document.createElement("rb");d.textContent=a;e=document.createElement("rt");e.textContent=c;c=document.createElement("ruby");c.className=f;c.appendChild(d);c.appendChild(e);c.ondblclick=function(){if(a&&
u())return ttsBean.speak(a)};b&&(c.onmouseover=function(a){return function(){if(!t())return this.title=a}}(b),c.onmouseout=function(){if(this.title)return this.removeAttribute("title")});return c};F=function(a){var c,b,f,d,e,g,h,k,l,M,m,n;if(c=jlpBean.parse(a)){a=document.createDocumentFragment();n=JSON.parse(c);k=0;for(M=n.length;k<M;k++){g=n[k];c=document.createElement("span");c.className="annot-ruby";e="";f=!1;l=0;for(m=g.length;l<m;l++)h=g[l],d=h[0],(b=C(d[0]))&&f&&(e+=" ",f=document.createTextNode(" "),
c.appendChild(f)),f=D(d.slice(-1)),e+=d,d=K.apply(this,h),c.appendChild(d);e&&(c.setAttribute("annot-text",e),c.onclick=p,c.onmouseover=v);a.appendChild(c)}return a}};y=function(a,c){var b;b=document.createElement("span");b.className="annot-tr";b.title=c;null!=c?(b.textContent=a,b.setAttribute("annot-text",c),b.onclick=p):b.title=a;return b};m=/([\u3010\u3011\u300c\u300d\u300e\u300f\u266a])/;r=/(.*?[\u2026\u2025\uff01\uff1f\u3002?!]+)/;H=function(a){var c,b,f,d,e,g,h,k,l;b=document.createDocumentFragment();
k=a.split(m);d=0;for(g=k.length;d<g;d++)if(c=k[d],1===a.length&&0<=L.call(m,a))b.appendChild(y(c));else for(l=c.split(r),e=0,h=l.length;e<h;e++)c=l[e],""!==c&&(f=trBean.translate(c,null),null!=f&&b.appendChild(y(f,c)));return b};x=function(a,c){var b;b=document.createElement("span");b.className="annot-src";b.textContent=a;c&&(b.setAttribute("annot-text",a),b.onclick=p,b.onmouseover=v);return b};G=function(a,c){var b,f,d,e,g,h,k,l;f=document.createDocumentFragment();k=a.split(m);d=0;for(g=k.length;d<
g;d++)if(b=k[d],1===a.length&&0<=L.call(m,a))f.appendChild(x(b,!1));else for(l=b.split(r),e=0,h=l.length;e<h;e++)b=l[e],""!==b&&f.appendChild(x(b,!0));return f};z=function(a,c){var b,f;f=document.createElement("div");f.className="annot-container";b=document.createElement("div");b.className="annot-child";b.appendChild(a);f.appendChild(b);b=document.createElement("div");b.className="annot-child";b.appendChild(c);f.appendChild(b);return f};s=function(a,c){var b;a=a.firstChild;for(b=[];null!=a;)3===a.nodeType?
c.push(a):1===a.nodeType&&s(a,c),b.push(a=a.nextSibling);return b};this.annotate=function(a){var c,b,f,d,e,g,h,k,l,m;a.className+=" annot-root";f=[];s(a,f);a=B();c=A();e=h=null;m=[];k=0;for(l=f.length;k<l;k++)b=f[k],(d=J(b.textContent))?(a&&(e=F(d)),c&&(h=H(d,b)),g=G(d,b),null!=e||null!=h?(d=document.createDocumentFragment(),d.appendChild(g),e&&h?d.appendChild(z(e,h)):(null!=e&&d.appendChild(e),null!=h&&d.appendChild(h))):d=g,m.push(b.parentNode.replaceChild(d,b))):m.push(void 0);return m};(function(){return null!=
document.body?annotate(document.body):window.onload=function(){return annotate(document.body)}})()}).call(this);
null
